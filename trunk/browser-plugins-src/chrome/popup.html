<style type="text/css">
.button {
	display: inline-block;
	zoom: 1; /* zoom and *display = ie7 hack for display:inline-block */
	*display: inline;
	vertical-align: baseline;
	margin: 0 2px;
	outline: none;
	cursor: pointer;
	text-align: center;
	text-decoration: none;
	font: 14px/100% Arial, Helvetica, sans-serif;
	padding: .5em 2em .55em;
	text-shadow: 0 1px 1px rgba(0, 0, 0, .3);
	-webkit-border-radius: .5em;
	-moz-border-radius: .5em;
	border-radius: .5em;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, .2);
	-moz-box-shadow: 0 1px 2px rgba(0, 0, 0, .2);
	box-shadow: 0 1px 2px rgba(0, 0, 0, .2);
}
.button:hover {
	text-decoration: none;
}
.button:active {
	position: relative;
	top: 1px;
}
.bigrounded {
	-webkit-border-radius: 2em;
	-moz-border-radius: 2em;
	border-radius: 2em;
}
.medium {
	font-size: 12px;
	padding: .4em 1.5em .42em;
}
.small {
	font-size: 11px;
	padding: .2em 1em .275em;
}
.orange {
	color: #fef4e9;
	border: solid 1px #da7c0c;
	background: #f78d1d;
	background: -webkit-gradient(linear, left top, left bottom, from(#faa51a),to(#f47a20) );
	background: -moz-linear-gradient(top, #faa51a, #f47a20);
	filter: progid : DXImageTransform.Microsoft.gradient ( startColorstr =
		'#faa51a', endColorstr = '#f47a20' );
}
.orange:hover {
	background: #f47c20;
	background: -webkit-gradient(linear, left top, left bottom, from(#f88e11),to(#f06015) );
	background: -moz-linear-gradient(top, #f88e11, #f06015);
	filter: progid : DXImageTransform.Microsoft.gradient ( startColorstr = '#f88e11', endColorstr = '#f06015' );
}
.orange:active {
	color: #fcd3a5;
	background: -webkit-gradient(linear, left top, left bottom, from(#f47a20),to(#faa51a) );
	background: -moz-linear-gradient(top, #f47a20, #faa51a);
	filter: progid : DXImageTransform.Microsoft.gradient ( startColorstr = '#f47a20', endColorstr = '#faa51a' );
}
ul {
	list-style: none;
	margin: 0px;
	padding: 0px;
}
</style>
<script type="text/javascript" src="jquery.min.js" ></script>

<div style="width: 280px; margin: 10px;" >
	Options:<br>
	<select id="option_box" onchange="optionHandler(this)">
		<option value="save">Save</option>
		<option value="search">Search</option>
		<option value="gplus_btn">G+ button</option>
	</select>
	<ul id="panel_list" >
		<li id="save" >			
			<input type="text" id="theTags" value="" style="width: 270px; margin: 5px;" placeholder="Enter the tags here (separated by space)" />
			<a href="javascript:postSaveDataByMethodPOST()" class="button orange bigrounded" title="Save to my brain" style="float: right; margin: 10px;" >Save</a>
	 	</li>
	  	<li id="search" >
	  		<input type="text" id="theKeywords" value="" style="width: 270px; margin: 5px;" placeholder="Enter the keywords here" />
	  		<a href="javascript:openSearchForm()" class="button orange bigrounded" title="Search" style="float: right; margin: 10px;" >Search</a>
		</li>
	  	<li id="gplus_btn" >
		  	<div id="plusone_holder" style="margin: 10px;">
				<div id="plusone_btn" class="g-plusone" data-annotation="inline" callback="plusoneCallback" data-href=""></div>
			</div>
	  	</li>
	</ul>
</div> 

<script type="text/javascript" >	
	var initSelectionBox = function(){
		jQuery('#panel_list').find('li').hide();
		jQuery('#panel_list').find('#save').show();
	};
	initSelectionBox();
	
	var optionHandler = function(n){
		jQuery('#panel_list').find('li').hide();
		jQuery( '#' + jQuery(n).val() ).show();		
	};
	
	jQuery('#theTags').keyup(function(event) {
	  	if (event.keyCode == '13') {
	  		postSaveDataByMethodPOST();
		}
	});
	
	jQuery('#theKeywords').keyup(function(event) {
	  	if (event.keyCode == '13') {
	  		openSearchForm();
		}
	});
	
	//chrome.tts.speak('Please, enter your tags for this page!', {'lang': 'en-US', 'rate': 1.0});
	
	var curTabId = 0;
	function postSaveDataByMethodPOST() {		
		var tagText = document.getElementById('theTags').value;		
		chrome.tabs.getSelected(null, function(tab) {
			curTabId = tab.id;
			
			chrome.tabs.sendRequest(tab.id, {
				method : "postDataLink",
				tabid : tab.id,
				tags : tagText
			}, function(response) {				
				//alert(response.href);
				//chrome.tabs.remove(curTabId);
				self.close();
			});
		});		
	}
	
	function openSearchForm(){
		var keywords = jQuery("#theKeywords").val();		
		var viewTabUrl = [ chrome.extension.getURL('search.html'), '?keywords=',	encodeURIComponent(keywords) ].join('');
		chrome.tabs.create({url : viewTabUrl });	
	}
	
	chrome.tabs.getSelected(null, function(tab) {			
		chrome.tabs.sendRequest(tab.id, {
			method : "getCurrentUrl"				
		}, function(response) {
			var node = document.getElementById('plusone_btn');
			node.setAttribute('data-href',response.href);
			var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
			po.src = 'https://apis.google.com/js/plusone.js';
			document.getElementById('plusone_holder').appendChild(po);
		});
	});	
	
</script>